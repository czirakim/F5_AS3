{
  "version": 4,
  "terraform_version": "1.4.4",
  "serial": 114,
  "lineage": "c3478034-b7e3-122b-1063-c199e83312a1",
  "outputs": {},
  "resources": [
    {
      "mode": "data",
      "type": "template_file",
      "name": "init",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "33e2744325889b03b6061d2715cf6c89ac1cc0ec5e1d0d2a260bd7eae6ae4a8a",
            "rendered": "{\n    \"$schema\": \"https://raw.githubusercontent.com/F5Networks/f5-appsvcs-extension/master/schema/latest/as3-schema.json\",\n    \"class\": \"AS3\",\n    \"action\": \"deploy\",\n    \"persist\": true,\n    \"declaration\": {\n        \"class\": \"ADC\",\n        \"schemaVersion\": \"3.0.0\",\n        \"id\": \"Tenant_01-declaration\",\n        \"label\": \"Tenant_01\",\n        \"remark\": \"HTTP application\",\n        \"updateMode\" :\"selective\",\n        \"Tenant_01\": {\n            \"class\": \"Tenant\",\n            \"defaultRouteDomain\": 0,\n            \"Application_1\": {\n                \"class\": \"Application\",\n                \"template\": \"Service_Generic\",\n            \"service_01\": {\n                \"class\": \"Service_HTTP\",\n                \"virtualAddresses\": [\n                    \"10.0.0.131\"\n                ],\n                \"virtualPort\": 80,\n                \"persistenceMethods\": [\n                    \"cookie\"\n                ],\n                \"profileTCP\": \"normal\",\n                \"profileHTTP\": {\n                    \"use\": \"http-xForwardedFor\"\n                },\n                \"snat\": \"auto\",\n                \"iRules\": [\n                    \"rule1\"\n                  ],\n                \"pool\": \"webpool\"\n                },\n                \"rule1\": {\n                    \"class\": \"iRule\",\n                    \"remark\": \"choose private pool based URI\",\n                    \"iRule\": {\n                        \"url\": \"https://raw.githubusercontent.com/czirakim/F5_AS3/master/rule1.irule\"\n                    }\n                  },\n                \"http-xForwardedFor\":{\n                    \"class\": \"HTTP_Profile\",\n                    \"xForwardedFor\": true\n                },\n                \"webpool\": {\n                    \"class\": \"Pool\",\n                    \"loadBalancingMode\":\"least-connections-member\",\n                    \"monitors\": [\n                        \"http\"\n                    ],\n                    \"members\": [\n                        {\n                            \"servicePort\": 8080,\n                            \"serverAddresses\": [\"1.1.1.1\",\"9.9.9.9\"]                                               \n                        }\n                    ]\n                },\n                \"abc_pool\": {\n                    \"class\": \"Pool\",\n                    \"loadBalancingMode\":\"least-connections-member\",\n                    \"monitors\": [\n                        \"http\"\n                    ],\n                    \"members\": [\n                        {\n                            \"servicePort\": 8080,\n                            \"serverAddresses\": [\"8.8.8.8\",\"8.8.4.4\"]                                               \n                        }\n                    ]\n                }\n            }\n        }\n    }\n}",
            "template": "{\n    \"$schema\": \"https://raw.githubusercontent.com/F5Networks/f5-appsvcs-extension/master/schema/latest/as3-schema.json\",\n    \"class\": \"AS3\",\n    \"action\": \"deploy\",\n    \"persist\": true,\n    \"declaration\": {\n        \"class\": \"ADC\",\n        \"schemaVersion\": \"3.0.0\",\n        \"id\": \"${TENANT}-declaration\",\n        \"label\": \"${TENANT}\",\n        \"remark\": \"HTTP application\",\n        \"updateMode\" :\"selective\",\n        \"${TENANT}\": {\n            \"class\": \"Tenant\",\n            \"defaultRouteDomain\": 0,\n            \"Application_1\": {\n                \"class\": \"Application\",\n                \"template\": \"Service_Generic\",\n            \"${VIP_NAME}\": {\n                \"class\": \"Service_HTTP\",\n                \"virtualAddresses\": [\n                    \"${VIP}\"\n                ],\n                \"virtualPort\": 80,\n                \"persistenceMethods\": [\n                    \"${PERSISTANCE}\"\n                ],\n                \"profileTCP\": \"normal\",\n                \"profileHTTP\": {\n                    \"use\": \"${HTTP_PROFILE}\"\n                },\n                \"snat\": \"auto\",\n                \"iRules\": [\n                    \"${IRULE_NAME}\"\n                  ],\n                \"pool\": \"${POOL1}\"\n                },\n                \"${IRULE_NAME}\": {\n                    \"class\": \"iRule\",\n                    \"remark\": \"choose private pool based URI\",\n                    \"iRule\": {\n                        \"url\": \"${IRULE}\"\n                    }\n                  },\n                \"${HTTP_PROFILE}\":{\n                    \"class\": \"HTTP_Profile\",\n                    \"xForwardedFor\": true\n                },\n                \"${POOL1}\": {\n                    \"class\": \"Pool\",\n                    \"loadBalancingMode\":\"${LB_MODE}\",\n                    \"monitors\": [\n                        \"${MONITOR}\"\n                    ],\n                    \"members\": [\n                        {\n                            \"servicePort\": ${SERVICEPORT},\n                            \"serverAddresses\": ${MEMBERS_1}                                               \n                        }\n                    ]\n                },\n                \"${POOL2}\": {\n                    \"class\": \"Pool\",\n                    \"loadBalancingMode\":\"${LB_MODE}\",\n                    \"monitors\": [\n                        \"${MONITOR}\"\n                    ],\n                    \"members\": [\n                        {\n                            \"servicePort\": ${SERVICEPORT},\n                            \"serverAddresses\": ${MEMBERS_2}                                               \n                        }\n                    ]\n                }\n            }\n        }\n    }\n}",
            "vars": {
              "HTTP_PROFILE": "http-xForwardedFor",
              "IRULE": "https://raw.githubusercontent.com/czirakim/F5_AS3/master/rule1.irule",
              "IRULE_NAME": "rule1",
              "LB_MODE": "least-connections-member",
              "MEMBERS_1": "[\"1.1.1.1\",\"9.9.9.9\"]",
              "MEMBERS_2": "[\"8.8.8.8\",\"8.8.4.4\"]",
              "MONITOR": "http",
              "PERSISTANCE": "cookie",
              "POOL1": "webpool",
              "POOL2": "abc_pool",
              "SERVICEPORT": "8080",
              "TENANT": "Tenant_01",
              "VIP": "10.0.0.131",
              "VIP_NAME": "service_01"
            }
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "bigip_as3",
      "name": "as3-deploy-tenant",
      "provider": "provider[\"registry.terraform.io/f5networks/bigip\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "application_list": "Application_1",
            "as3_json": "{\"action\":\"deploy\",\"class\":\"AS3\",\"declaration\":{\"Tenant_01\":{\"Application_1\":{\"abc_pool\":{\"class\":\"Pool\",\"loadBalancingMode\":\"least-connections-member\",\"members\":[{\"serverAddresses\":[\"8.8.8.8\",\"8.8.4.4\"],\"servicePort\":8080}],\"monitors\":[\"http\"]},\"class\":\"Application\",\"http-xForwardedFor\":{\"class\":\"HTTP_Profile\",\"xForwardedFor\":true},\"rule1\":{\"class\":\"iRule\",\"iRule\":{\"url\":\"https://raw.githubusercontent.com/czirakim/F5_AS3/master/rule1.irule\"},\"remark\":\"choose private pool based URI\"},\"service_01\":{\"class\":\"Service_HTTP\",\"iRules\":[\"rule1\"],\"persistenceMethods\":[\"cookie\"],\"pool\":\"webpool\",\"profileHTTP\":{\"use\":\"http-xForwardedFor\"},\"profileTCP\":\"normal\",\"snat\":\"auto\",\"virtualAddresses\":[\"10.0.0.131\"],\"virtualPort\":80},\"template\":\"Service_Generic\",\"webpool\":{\"class\":\"Pool\",\"loadBalancingMode\":\"least-connections-member\",\"members\":[{\"serverAddresses\":[\"1.1.1.1\",\"9.9.9.9\"],\"servicePort\":8080}],\"monitors\":[\"http\"]}},\"class\":\"Tenant\",\"defaultRouteDomain\":0},\"class\":\"ADC\",\"id\":\"Tenant_01-declaration\",\"label\":\"Tenant_01\",\"remark\":\"HTTP application\",\"schemaVersion\":\"3.0.0\"},\"persist\":true}",
            "id": "Tenant_01",
            "ignore_metadata": false,
            "tenant_filter": null,
            "tenant_list": "Tenant_01",
            "tenant_name": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "data.template_file.init"
          ]
        }
      ]
    }
  ],
  "check_results": null
}
